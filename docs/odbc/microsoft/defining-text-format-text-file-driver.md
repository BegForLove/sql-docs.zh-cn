---
title: 定义文本格式 （文本文件驱动程序） |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 500a81146397fa5c50bd8b74c600d04887ecc99c
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/15/2019
ms.locfileid: "68096355"
---
# <a name="defining-text-format-text-file-driver"></a>定义文本格式（文本文件驱动程序）
使用文本驱动程序时，可以使用**定义文本格式**对话框可以在所选文件中定义的列的格式。 此对话框中，您可以指定每个数据表的架构。 此信息写入到中的数据源目录的 Schema.ini 文件。 为每个文本数据源目录创建单独的 Schema.ini 文件。  
  
> [!NOTE]  
>  相同的默认文件格式适用于所有新的文本数据表格。 由 CREATE TABLE 语句创建的所有文件都会都继承这些相同的默认格式值，该值通过选择文件格式中的值来设置**定义文本格式**带有对话框\<默认 >中选择**表**列表。 文本驱动程序不会更改现有文本文件以匹配在此对话框中定义的格式的格式，但它使用的格式，例如当它尝试从文本文件检索数据时将返回错误。  
  
 中提供了以下选项**定义文本格式**对话框：  
  
|Option|Information|  
|------------|-----------------|  
|**“添加”**|添加使用中的值的列**数据类型**，**名称**，并**宽度**从对话框中，并且如果适用，日期分隔符值从 Schema.ini。|  
|**字符**|**ANSI**或**OEM**。 OEM 可指定非 ANSI 字符集。 如果在选择的项的格式，则默认为 OEM**表**列表不以前定义的此对话框。|  
|**列名称标题**|指示所选表的第一行的列是否用作列名称。 任一 **，则返回 TRUE**或**FALSE**。 默认为 FALSE; 中的选定项的格式**表**列表不以前定义的此对话框。|  
|**“列”**|列出所选表中各列的列名称。 列的顺序反映了表中列的顺序。 如果在中选择了一个文件启用此列表**表**列表。|  
|**数据类型**|可以是位、 字节、 CHAR、 货币、 日期、 FLOAT、 整数、 LONGCHAR、 SHORT 或单。 日期数据类型可以采用以下格式:"年-mmm-日"、"月-日-年"、"mmm-日-年"、"年-月-日"或"年-mmm-日"。 "mm"表示数字个月;个月，"mmm"表示字母。|  
|**分隔符**|指定要用来分隔列的自定义分隔符字符。 启用时**自定义分隔**选择格式。 分隔符可以是只有一个字符的长度，并且两个双引号 （"） 不能用作分隔符字符。 （分隔符不能指定以十六进制还是以十进制格式。）|  
|**格式**|分隔或固定长度。 如果带分隔符、 指示使用的分隔符类型： 以逗号 (CSV)、 制表符或特殊字符 （自定义）。 此值默认为**CSV 分隔**如果在选择的项的格式**表**列表不以前定义的此对话框。<br /><br /> 如果**格式**是固定长度和**列名称标题**为 TRUE 时，第一行必须是以逗号分隔。|  
|**猜测**|通过扫描根据表的内容将自动生成所选表中列的数据类型、 名称和宽度值的列**格式**框选择。 启用时分隔的表格格式。 任何以前定义的中的列**列**列表是清除并替换为新条目。 如果**列名称标题**是未选中，列名称自动生成为"F1"、"F2"，等等。 没有默认值所示**数据类型**框。<br /><br /> 此功能仅适用于小于 64,513 字节的列。|  
|**修改**|修改所选的列中的值**数据类型**，**名称**，并**宽度**。|  
|**名称**|显示所选列的名称。 可用于指定新的列名称的现有列或新列。<br /><br /> 如果**列名称标题**为 TRUE 时，此列显示的名称被忽略。|  
|**删除**|删除所选的列。|  
|**扫描的行数**|设置列和列数据类型取决于现有数据时，安装程序或驱动程序将扫描的行数。<br /><br /> 您可以输入介于 1 到 32767 之间的要扫描的行数。 此值默认为 25 如果中的选定项的格式**表**列表不以前定义的此对话框。 （限制以外的数字将返回错误。）|  
|**表**|包含列表中选择的目录中的所有文件**文本安装**与指定扩展名的列表匹配的对话框。<br /><br /> 时\<默认值 > 选择时，以下项之一为 true 中的表属性的值和**表**组写入的 Schema.ini （接触 Schema.ini 中的没有其他项）：<br /><br /> -无 Schema.ini 中指定的目录。<br />Schema.ini 文件存在，但在一个文本文件 （扩展名为指定） 的目录中的 Schema.ini 没有部分。<br />的文本文件部分存在于 Schema.ini，但响应正文为空。<br /><br /> 当\<默认值 > 选择，则**列**禁用组。|  
|宽度 |对于 CHAR 或 LONGCHAR 列，可以更改列的宽度。 默认为 1，如果格式中的选定项的宽度**表**列表不以前定义的此对话框。<br /><br /> 对于其他数据类型，区分控件处于禁用状态并不显示任何值。|
