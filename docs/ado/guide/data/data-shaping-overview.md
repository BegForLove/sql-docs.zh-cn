---
title: 数据整理概述 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], overview
ms.assetid: 4cb5fd29-4e56-46ac-ae48-a6771c321c0c
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 64b54acb2334aa09c5d4c2fde421f1dca9f8f3c5
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "62472389"
---
# <a name="data-shaping-overview"></a>数据整理概述
*数据整理*意味着构建在查询中的两个或多个逻辑实体之间的层次结构关系。 在层次结构所示的一个记录之间的父-子关系[记录集](../../../ado/reference/ado-api/recordset-object-ado.md)，和一个或多个记录 （也称为一章） 的另一个**记录集**。 在父-子关系中，父**记录集**包含子级**记录集**。 此类层次结构关系的一个示例是客户和订单。 对于在数据库中每位客户，可以有零个或多个订单。 层次结构关系可以是递归的这意味着，可以嵌套子记录中的孙级记录。 原则上，可以任意深度嵌套的分层记录。 在实践中，ADO 限制到最多 512 个递归**记录集**s。  
  
 中的形状的常规，列**记录集**可以包含来自如 Microsoft® SQL Server，对另一个引用数据提供程序的数据**记录集**，从的单个行的计算得出的值**记录集**，或通过为整个列派生一个操作值**记录集**。 虚构和为空，也可以新是一个列。  
  
 检索包含到另一个引用列的值时**记录集**，ADO 将自动返回的实际**记录集**表示引用。 对引用**记录集**是实际的子级，名为子集的引用*章*。 单一父可以引用多个子**记录集**。  
  
 ADO 数据整理的支持，可查询的数据源并返回**记录集**（父） 记录表示 （子）**记录集**。 在客户订单方案中，可以使用数据整理来检索客户的信息，以及在单个查询中的每个客户的订单。 所产生的**记录集**也称为形状**记录集**。  
  
 此外，数据在 ADO 中整理允许你创建新**记录集**对象，而通过使用基础数据源**新建**关键字来描述的字段的父级和子级**记录集**。 新**记录集**对象随后可使用数据填充并持久地存储。 开发人员还可以执行各种计算或聚合 (例如，**总和**， **AVG**，并**最大**) 在子字段。 数据整理还可以创建父**记录集**来自子元素**记录集**分组子组织单位中的记录，然后将一个行放在子组织单位中的每个组的父级。  
  
 常规 SQL 允许您检索使用数据**加入**语法，但这可能效率低下且不实用因为冗余父数据重复返回给定的父-子关系的每个记录中。 数据整理可以使相关的父代中的单一父记录**记录集**子组织单位中的多个子记录**记录集**，避免的冗余**加入**。 大多数人都认为父-子多个**记录集**编程模型更加自然且更轻松地使用比单**记录集加入**模型。
