---
title: 何时使用过程 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 6f25b629372bbe089489cccdbfa0258dafef3dd0
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/15/2019
ms.locfileid: "68078974"
---
# <a name="when-to-use-procedures"></a>何时使用过程
有很多优点使用过程，所有基于的事实，使用过程的 SQL 语句将从移动到数据源的应用程序。 什么保留在应用程序是一个可互操作的过程调用。 这些优点包括：  
  
-   **性能**过程通常是执行 SQL 语句的最快方法。 如准备的执行，该语句编译和执行在两个单独的步骤。 准备好的执行，与仅在运行时执行过程。 它们在不同时间进行编译。  
  
-   **业务规则**A*业务规则*是一家公司经营的方式有关的规则。 例如，只有具有标题销售人员的人员可能允许添加新的销售订单。 放置过程中的这些规则可让单个公司通过重写应用程序而无需修改应用程序代码调用的过程中自定义垂直应用程序。 例如，订单输入应用程序可能会调用该过程**InsertOrder**具有固定数量的参数; 精确**InsertOrder**实现因公司而异。  
  
-   **Replaceability**密切相关放置过程中的业务规则是，无需重新编译应用程序，可以替换为过程的这一事实。 如果公司已购买并安装了应用程序后发生更改业务规则，该公司可以更改包含该规则的过程。 从应用程序的角度来看，没有进行任何更改;它仍然会调用某一特定的过程来完成特定任务。  
  
-   **如何使用特定于 SQL**过程提供了一种方法的应用程序来利用特定于 DBMS 的 SQL，同时保持可互操作。 例如上支持在 SQL 中的控制流语句的 DBMS, 的过程可能会捕获并从此错误，而上不支持控制流语句的 DBMS 的过程可能会只返回错误。  
  
-   **过程幸存事务**上某些数据源，在连接上所有预定义语句的访问计划时，会删除已提交或回滚事务。 通过将 SQL 语句放在过程中，它们永久地存储在数据源中，这些语句后丢失该事务。 过程幸存是否在已准备好，部分已准备好，或尚未准备好的状态是特定于 DBMS 的。  
  
-   **独立开发**过程可以单独开发应用程序的其余部分。 在大型公司而言，这可能会提供一种方法来进一步利用高度专业化的编程人员的技能。 换而言之，应用程序设计人员可以编写用户界面代码和数据库程序员可以编写过程。  
  
 垂直和自定义应用程序通常使用过程。 这些应用程序往往会执行固定的任务，并可以在其中硬编码过程调用。 例如，订单输入应用程序可能调用的过程**InsertOrder**， **DeleteOrder**， **UpdateOrder**，以及**GetOrders**.  
  
 没有理由从泛型应用程序调用过程。 过程通常编写特定的应用程序的上下文中执行任务，因此无需使用泛型应用程序。 例如，电子表格具有无需调用**InsertOrder**刚刚提到的过程。 此外，通用应用程序不应构造过程在运行时以确保其达到提供更快的语句执行。不只是速度要慢于已准备好或直接执行，这可能还需要特定于 DBMS 的 SQL 语句。  
  
 一种例外是应用程序开发环境，通常提供某种方式让设计人员构建 SQL 语句的执行过程，并可能提供某种方式让程序员来测试过程。 此类环境调用**SQLProcedures**对列表可用过程并**SQLProcedureColumns**若要列出的输入、 输入/输出和输出参数，该过程返回值和的列创建一个过程的任何结果集。 但是，此类过程必须在事先上开发的每个数据源;执行此操作需要特定于 DBMS 的 SQL 语句。  
  
 有三个主要缺点使用过程。 首先，必须编写和编译的应用程序运行是每个 DBMS 过程。 尽管这不是自定义应用程序的问题，这样可以显著提高开发和维护垂直应用程序设计为与 Dbms 的运行时间。  
  
 第二个缺点是，许多 Dbms 不支持过程。 同样，这是最有可能是设计为运行与的 Dbms 的垂直应用程序的问题。 若要确定是否支持过程，应用程序调用**SQLGetInfo** SQL_PROCEDURES 选项。  
  
 第三个缺点，这尤其适用于应用程序开发环境，是 ODBC 不会定义用于创建过程的标准语法。 也就是说，尽管应用程序可以 interoperably 调用过程，但它们不能 interoperably 创建它们。
