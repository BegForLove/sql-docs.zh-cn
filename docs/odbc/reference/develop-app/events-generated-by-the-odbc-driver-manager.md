---
title: 由 ODBC 驱动程序管理器生成的事件 |微软文档
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], events generated by
- Visual Studio Analyzer [ODBC], driver manager events
ms.assetid: 8c6efbbd-2c7d-4342-aa7b-201f94b3e3e3
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a7ce17f9ef8e082f94609e0f8fc432b8963d73a6
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305748"
---
# <a name="events-generated-by-the-odbc-driver-manager"></a>ODBC 驱动程序管理器生成的事件
> [!IMPORTANT]  
>  从 Windows 8 开始删除了对可视化工作室分析器的支持（视觉工作室分析器仅包含在旧版本的 Visual Studio 中）。 对于其他故障排除机制，请使用 BID 跟踪。  
  
 单击"开始可视化工作室分析器"按钮时，将注册由 ODBC 驱动程序管理器生成的事件。 该工具本身提供系统定义的事件和创建自定义事件的能力。 有关事件的详细信息，请参阅可视化工作室文档套件中的*可视化工作室分析器参考指南*。  
  
|可视化工作室分析器事件|描述|  
|----------------------------------|-----------------|  
|**调用**|在每个 ODBC API 条目上生成。|  
|**返回例外**|如果返回代码SQL_ERROR，则在每个 ODBC API 返回上生成。|  
|**返回法线**|如果未SQL_ERROR返回代码，则在每个 ODBC API 上生成。|  
|**连接启动**|指示连接已启动;当 ODBC 驱动程序管理器调用驱动程序的连接 API 时生成。|  
|**连接完成**|指示连接已完成;当驱动程序的连接 API 返回到 ODBC 驱动程序管理器时生成。|  
|**断开连接开始**|当 ODBC 驱动程序管理器调用驱动程序的**SQLDisconnect**函数时生成。|  
|**断开连接完成**|当驱动程序的**SQLDisconnect**函数返回到 ODBC 驱动程序管理器时生成。|  
|**查询发送**|当 ODBC 驱动程序管理器调用驱动程序的 SQLPrepare、SQLExecute、SQLExecDirect 函数以及目录函数（如**SQLTables**和**SQLColumns）** 时生成。 **SQLPrepare** **SQLExecute** **SQLExecDirect**|  
|**查询结果**|当驱动程序将结果集返回到涉及查询的函数时生成。|  
|**事务开始**|当应用程序将SQL_ATTR_AUTOCOMMIT的值设置为SQL_AUTOCOMMIT_OFF时，或在应用程序成功调用**SQLEndTran**之后生成。|  
|**事务提交**|当应用程序调用**SQLEndTran**提交本地事务时生成。|  
|**事务回滚**|当应用程序调用**SQLEndTran**回滚本地事务时生成。|  
|**加入DTC**|当应用程序加入分布式事务协调器 （DTC） 时生成。|  
|**离开DTC**|当应用程序离开分布式事务协调器 （DTC） 时生成。|
