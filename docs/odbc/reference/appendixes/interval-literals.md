---
title: 间隔文本 |微软文档
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- data types [ODBC], interval data types
- interval literals [ODBC]
- interval data type [ODBC], literals
ms.assetid: f9e6c3c7-4f98-483f-89d8-ebc5680f021b
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: c1761ac0acb57b3f375a7d19e9371384c000eca5
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304938"
---
# <a name="interval-literals"></a>间隔文本
ODBC 要求所有驱动程序都支持将SQL_CHAR或SQL_VARCHAR数据类型转换为所有 C 间隔数据类型。 但是，如果基础数据源不支持间隔数据类型，则驱动程序需要知道SQL_CHAR字段中值的正确格式，以支持这些转换。 同样，ODBC 要求任何 ODBC C 类型都可转换为SQL_CHAR或SQL_VARCHAR，因此驱动程序需要知道字符字段中存储的间隔应具有哪种格式。 本节介绍间隔文本的语法，驱动程序编写器需要在转换到 C 间隔数据类型或从 C 间隔数据类型转换期间使用该语法来验证SQL_CHAR字段。  
  
> [!NOTE]  
>  间隔文本的完整 BNF 语法显示在附录 C 中的["间隔文本语法](../../../odbc/reference/appendixes/interval-literal-syntax.md)"部分：SQL 语法中。  
  
 要将间隔文本作为 SQL 语句的一部分传递，为间隔文本定义转义子句语法。 有关详细信息，请参阅[日期、时间和时间戳文本](../../../odbc/reference/develop-app/date-time-and-timestamp-literals.md)。  
  
 间隔文本为窗体：  
  
```  
INTERVAL[<sign>] 'value' <interval qualifier>  
```  
  
 其中"INTERVAL"表示字符文本是间隔。 符号可以是正负;它在间隔字符串之外，是可选的。  
  
 间隔限定符可以是单个日期时间字段，也可以由两个日期时间字段组成，形式为：\<*前导字段*> to \<*跟踪字段*>。  
  
-   当间隔由单个字段组成时，单个字段可以是一个非秒字段，并可伴有括号中的可选前导精度。 单日期时间字段也可以是第二个字段，可以附带可选的前导精度、括号中的可选小数秒精度，或两者。 如果前导精度和分数秒精度都存在秒字段，则它们由逗号分隔。 如果秒字段具有分数秒精度，则还必须具有前导精度。  
  
-   当间隔由前导和尾随字段组成时，前导字段是一个非秒字段，可能伴随着括号中的间隔前导场精度。 尾随字段可以是非秒字段，也可以是第二个字段，在括号中可能伴随着间隔分数秒精度。  
  
 *值*中的间隔字符串以单个引号括起来。 它可以是一年月字面或白天的字面。 *值*字符串的格式由以下规则确定：  
  
-   字符串包含\<*间隔**限定符*>隐含的每个字段的小数值。  
  
-   如果间隔精度包括字段 YEAR 和 MONTH，则这些字段的值用减号分隔。  
  
-   如果间隔精度包括字段 DAY 和 HOUR，则这些字段的值由空格分隔。  
  
-   如果间隔精度包括字段 HOUR 和较低阶字段（分钟字段和秒），则这些字段的值由冒号分隔。  
  
-   如果间隔精度包含一个"秒"字段，并且表示或隐含的秒精度是非零，则紧邻第二个小数部分第一个数字之前的字符是句点。  
  
-   除以下情况外，任何字段都不可能超过两位数字长：  
  
    -   前导字段的值可以是表示或隐含的间隔前导精度。  
  
    -   第二个字段的小数部分可以长达表示或隐含的秒精度。  
  
    -   尾随字段遵循公历的通常约束。 （请参阅[公历的约束](../../../odbc/reference/appendixes/constraints-of-the-gregorian-calendar.md)。  
  
 下表列出了带间隔的 ODBC 转义子句中包含的有效间隔文本示例。 转义子句的语法如下：  
  
> [!NOTE]  
>  *[INTERVAL 符号间隔-字符串间隔限定符]*  
  
|文本转义子句|指定间隔|  
|---------------------------|------------------------|  
|[间隔 '326' 年份 （4）]|指定 326 年的间隔。 间隔前导精度为 4。|  
|{间隔 '326' 月 （3）]|指定 326 个月的间隔。 间隔前导精度为 3。|  
|{间隔 '3261' 天 （4）]|指定 3261 天的间隔。 间隔前导精度为 4。|  
|[间隔 '163' 小时 （3）]|指定 163 天的间隔。 间隔前导精度为 3。|  
|[间隔 '163' 分钟 （3）]|指定 163 分钟的间隔。 间隔前导精度为 3。|  
|[间隔 '223.16' 秒 （3，2）]|指定 223.16 秒的间隔。 间隔前导精度为 3，秒精度为 2。|  
|[间隔 '163-11' 年份 （3） 到月]|指定 163 年和 11 个月的间隔。 间隔前导精度为 3。|  
|[间隔 '163 12' 天 （3） 到小时*|指定 163 天和 12 小时的间隔。 间隔前导精度为 3。|  
|[间隔 '163 12：39' 天 （3） 到分钟*|指定 163 天、12 小时和 39 分钟的间隔。 间隔前导精度为 3。|  
|{间隔 '163 12：39：59.163" 天 （3） 到秒 （3）]|指定 163 天、12 小时、39 分钟和 59.163 秒的间隔。 间隔前导精度为 3，秒精度为 3。|  
|[间隔 '163：39' 小时 （3） 到分钟*|指定 163 小时 39 分钟的间隔。 间隔前导精度为 3。|  
|{间隔 '163：39：59.163' 小时 （3） 到秒 （4）]|指定 163 小时、39 分钟和 59.163 秒的间隔。 间隔前导精度为 3，秒精度为 4。|  
|[间隔 '163：59.163' 分钟 （3） 到秒 （5）]|指定 163 分钟和 59.163 秒的间隔。 间隔前导精度为 3，秒精度为 5。|  
|[间隔 - '16 23：39：56.23' 一天到第二*|指定零下 16 天、23 小时、39 分钟和 56.23 秒的间隔。 隐含前导精度为 2，隐含秒精度为 6。|  
  
 下表列出了无效间隔文本的示例：  
  
|文本转义子句|无效的原因|  
|---------------------------|------------------------|  
|[间隔 '163' 小时 （2）]|间隔前导精度为 2，但前导字段的值为 163。|  
|[间隔 '223.16' 秒 （2，2）]<br /><br /> [间隔 '223.16' 秒 （3，1）]|在第一个示例中，前导精度太小，在第二个示例中，秒精度太小。|  
|[间隔 '223.16' 秒]<br /><br /> [间隔 '223' 年份]|由于未指定前导精度，因此默认为 2，该精度太小，无法容纳指定的文本。|  
|[间隔 '22.1234567' 秒]|秒精度未指定，因此默认为 6。 文本在小数点后有七位数字。|  
|[间隔 '163-13' 年份 （3） 到月]<br /><br /> [间隔 '163 65' 天 （3） 到小时*<br /><br /> [间隔 '163 62：39' 天 （3） 到分钟*<br /><br /> {间隔 '163 12：125：59.163" 天 （3） 到秒 （3）]<br /><br /> [间隔 '163：144' 小时 （3） 到分钟*<br /><br /> {间隔 '163：567：234.163' 小时 （3） 到秒 （4）]<br /><br /> {间隔 '163：591.163' 分钟 （3） 到秒 （5）]|尾随字段不遵循公历的规则。|
