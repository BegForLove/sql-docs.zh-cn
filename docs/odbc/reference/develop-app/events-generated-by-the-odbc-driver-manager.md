---
title: 通过 ODBC 驱动程序管理器所生成的事件 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], events generated by
- Visual Studio Analyzer [ODBC], driver manager events
ms.assetid: 8c6efbbd-2c7d-4342-aa7b-201f94b3e3e3
author: MightyPen
ms.author: genemi
ms.openlocfilehash: cd52aa1427e5fa768ab521d3533cbabfa4d6ad0f
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/15/2019
ms.locfileid: "67901354"
---
# <a name="events-generated-by-the-odbc-driver-manager"></a>ODBC 驱动程序管理器生成的事件
> [!IMPORTANT]  
>  在 Windows 8 中 （Visual Studio 分析器仅包含在较旧版本的 Visual Studio。） 开始已不再对 Visual Studio 分析器的支持。 有关故障排除机制的替代方法，使用 BID 跟踪。  
  
 单击启动 Visual Studio 分析器按钮时注册由 ODBC 驱动程序管理器生成的事件。 该工具本身提供了系统定义的事件和创建自定义事件的能力。 有关事件的详细信息，请参阅*Visual Studio 分析器参考指南*Visual Studio 系列产品文档中。  
  
|Visual Studio Analyzer 事件|描述|  
|----------------------------------|-----------------|  
|**调用**|生成 ODBC API 的每个条目。|  
|**ReturnException**|生成每个 ODBC API 返回 SQL_ERROR 返回代码时。|  
|**ReturnNormal**|生成每个 ODBC API 返回时，如果返回代码不是 SQL_ERROR。|  
|**连接开始**|指示连接已开始;ODBC 驱动程序管理器调用驱动程序的连接的 Api 时生成。|  
|**连接完成**|指示连接已完成;生成时，驱动程序的连接 Api 返回到 ODBC 驱动程序管理器。|  
|**断开连接启动**|当 ODBC 驱动程序管理器调用的驱动程序时，生成**SQLDisconnect**函数。|  
|**断开连接完成**|生成时，驱动程序的**SQLDisconnect**函数将返回到 ODBC 驱动程序管理器。|  
|**QuerySend**|当 ODBC 驱动程序管理器调用的驱动程序时，生成**SQLPrepare**， **SQLExecute**， **SQLExecDirect**函数，以及目录功能，如**SQLTables**并**SQLColumns**。|  
|**QueryResult**|该驱动程序返回的结果集为 ODBC 驱动程序管理器涉及查询的函数时生成。|  
|**TransactionStart**|生成时应用程序的 SQL_ATTR_AUTOCOMMIT 将值设置为 SQL_AUTOCOMMIT_OFF，或在应用程序已成功调用之后**SQLEndTran**。|  
|**TransactionCommit**|当应用程序调用时，生成**SQLEndTran**提交本地事务。|  
|**TransactionRollback**|当应用程序调用时，生成**SQLEndTran**回滚本地事务。|  
|**JoinDTC**|生成应用程序加入分布式事务处理协调器 (DTC) 时。|  
|**LeaveDTC**|当应用程序会使分布式事务处理协调器 (DTC) 时生成。|
