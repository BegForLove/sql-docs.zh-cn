---
title: "定义文本格式 （文本文件驱动程序） |Microsoft 文档"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.reviewer: 
ms.suite: 
ms.technology:
- drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
caps.latest.revision: 6
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.translationtype: MT
ms.sourcegitcommit: f7e6274d77a9cdd4de6cbcaef559ca99f77b3608
ms.openlocfilehash: ed4eb087a11db45f2e3841b6e65824f1076d3693
ms.contentlocale: zh-cn
ms.lasthandoff: 09/09/2017

---
# <a name="defining-text-format-text-file-driver"></a>定义文本格式 （文本文件驱动程序）
当使用文本驱动程序时，你可以使用**定义文本格式**对话框可以定义在所选文件中的列的格式。 此对话框中，你可以指定每个数据表的架构。 此信息写入到中的数据源目录的 Schema.ini 文件。 为每个文本数据源目录创建单独的 Schema.ini 文件。  
  
> [!NOTE]  
>  相同的默认文件格式适用于所有新的文本数据表格。 CREATE TABLE 语句创建的所有文件都继承这些相同的默认格式值，通过选择文件中的值设置格式设置**定义文本格式** 癸杠\<默认 > 选择**表**列表。 文本驱动程序不会更改以匹配在此对话框中，定义的格式的现有文本文件的格式，但它使用的格式，例如当它尝试从文本文件中检索数据时返回错误。  
  
 以下选项可用于中**定义文本格式**对话框中：  
  
|选项|信息|  
|------------|-----------------|  
|**添加**|添加使用中的值的列**数据类型**，**名称**，和**宽度**从对话框中，并且如果适用，日期分隔符值从 Schema.ini。|  
|**字符**|**ANSI**或**OEM**。 OEM 指定非 ANSI 字符集。 如果选择中的项的格式，则默认为 OEM**表**列表不以前定义过通过此对话框。|  
|**列名称标头**|指示所选表的第一行的列是否用于作为列名称。 任一**TRUE**或**FALSE**。 中的选定项的格式默认为 false**表**列表不以前定义过通过此对话框。|  
|**列**|列出所选表中每一列的列名称。 列的顺序反映表中的列的顺序。 如果尚未在选择了一个文件启用此列表**表**列表。|  
|**数据类型**|可以是位、 字节、 CHAR、 货币、 日期、 FLOAT、 整数、 LONGCHAR、 短，或单。 日期数据类型可以采用以下格式:"dd-mmm-yy"、"mm dd yy"、"mmm-dd-yy"、"yyyy-月-日"或"yyyy-mmm-日"。 "mm"表示个月; 数字"mmm"表示个月的字母。|  
|**分隔符**|指定要用于分隔列的自定义分隔符字符。 启用时**自定义分隔**选择格式。 分隔符可以是仅一个字符的长度，并且两个双引号 （"） 不能用作分隔符字符。 （分隔符不能指定十六进制或十进制格式。）|  
|**格式**|分隔或固定长度。 如果分隔，该值指示使用的分隔符类型： 以逗号 (CSV)、 制表符或特殊字符 （自定义）。 这将默认为**CSV 分隔**如果选择中的项的格式**表**列表不以前定义过通过此对话框。<br /><br /> 如果**格式**是固定长度和**列名称标头**为 TRUE 时，必须以逗号分隔的第一行。|  
|**猜测**|自动在所选表中生成列的数据类型、 名称和宽度值的列，通过扫描表的内容根据**格式**框中选择。 启用时分隔的表格格式。 任何以前定义中的列**列**列表清除，并将其替换为新条目。 如果**列名称标头**是未选择，可以将列名称自动将生成为"F1"、"F2"，依次类推。 没有默认值所示**数据类型**框。<br /><br /> 此功能仅适用于小于 64,513 字节的列。|  
|**修改**|修改使用中的值的所选的列**数据类型**，**名称**，和**宽度**。|  
|**名称**|显示所选列的名称。 可以用于指定现有列或新列的新列名称。<br /><br /> 如果**列名称标头**为 TRUE 时，列显示名称将被忽略。|  
|**删除**|删除所选的列。|  
|**扫描的行数**|在设置列和列数据类型取决于现有数据时，安装程序或驱动程序将扫描的行数。<br /><br /> 你可以输入一个介于 1 到 32767 之间的要扫描的行数。 这将默认为 25 如果中选定的项的格式**表**列表不以前定义过通过此对话框。 （限制以外的数字将返回错误。）|  
|**表**|包含列表中选择的目录中的所有文件**文本安装**对话框中指定的扩展名的列表相匹配。<br /><br /> 当\<默认 > 选择后，并且以下其中一个是 true，表中的属性的值**表**组写入的 Schema.ini （接触 Schema.ini 中的没有其他项）：<br /><br /> -没有任何 Schema.ini 指定目录中。<br />-该 Schema.ini 文件存在，但在目录中的文本文件 （具有指定的扩展） 之一的 Schema.ini 没有节。<br />的文本文件部分存在于 Schema.ini，但响应正文为空。<br /><br /> 当\<默认 > 选择，则**列**组处于禁用状态。|  
|**宽度**|可以为 CHAR 或 LONGCHAR 列更改列的宽度。 默认为 1 如果中选定的项的格式的宽度**表**列表不以前定义过通过此对话框。<br /><br /> 对于其他数据类型，禁用了宽度控件并不显示任何值。|
