---
title: SQLGetInfo（光标库） |微软文档
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLGetInfo function [ODBC], Cursor Library
ms.assetid: 1b4d220d-2c07-4f56-987e-36813bb1a6ce
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 9067fd8b33cb2408f1ef6f0e58603eb4f1f7eb09
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307808"
---
# <a name="sqlgetinfo-cursor-library"></a>SQLGetInfo（游标库）
> [!IMPORTANT]  
>  此功能将在将来版本的 Windows 中删除。 避免在新的开发工作中使用此功能，并计划修改当前使用此功能的应用程序。 Microsoft 建议使用驱动程序的光标功能。  
  
 本主题讨论在游标库中使用**SQLGetInfo**函数。 有关**SQLGetInfo 的**一般信息，请参阅[SQLGetInfo 函数](../../../odbc/reference/syntax/sqlgetinfo-function.md)。  
  
 游标库返回*InfoType*的以下值的值（&#124;表示位或）;对于*InfoType*的所有其他值，它在驱动程序中调用**SQLGetInfo。**  
  
|*信息类型*|返回值|  
|----------------|--------------------|  
|SQL_BOOKMARK_PERSISTENCE|SQL_BP_SCROLL|  
|SQL_DYNAMIC_CURSOR_ATTRIBUTES1|0|  
|SQL_DYNAMIC_CURSOR_ATTRIBUTES2|0|  
|SQL_FETCH_DIRECTION[1]|SQL_FD_FETCH_ABSOLUTE SQL_FD_FETCH_RELATIVE SQL_FD_FETCH_PRIOR &#124; SQL_FD_FETCH_NEXT &#124; &#124; SQL_FD_FETCH_FIRST&#124;SQL_FD_FETCH_LASTSQL_FD_FETCH_LASTSQL_FD_FETCH_LAST&#124;&#124;&#124;SQL_FD_FETCH_BOOKMARK|  
|SQL_FORWARD_ONLY_CURSOR_ATTRIBUTES1|SQL_CA1_NEXT &#124;SQL_CA1_ABSOLUTE &#124;SQL_CA1_ABSOLUTE &#124; SQL_CA1_POS_POSITION &#124; SQL_CA1_LOCK_NO_CHANGE SQL_CA1_RELATIVESQL_CA1_ABSOLUTE&#124;&#124;&#124;SQL_CA1_POSITIONED_DELETESQL_CA1_POSITIONED_DELETESQL_CA1_POSITIONED_UPDATE&#124;SQL_CA1_POSITIONED_DELETE&#124;&#124;SQL_CA1_SELECT_FOR_UPDATE|  
|SQL_FORWARD_ONLY_CURSOR_ATTRIBUTES2|&#124;SQL_CA2_SENSITIVITY_UPDATES&#124;&#124;SQL_CA2_READ_ONLY_CONCURSQL_CA2_OPT_VALUES_CONCURRENCY|  
|SQL_GETDATA_EXTENSIONS|SQL_GD_BLOCK&#124;驱动程序返回的任何值**注意：** 当使用**SQLFetchScroll**检索数据时 **，SQLGetData**支持使用SQL_GD_ANY_COLUMN和SQL_GD_BOUND位掩码指定的功能。|  
|SQL_KEYSET_DRIVEN_CURSOR_ATTRIBUTES1|0|  
|SQL_KEYSET_DRIVEN_CURSOR_ATTRIBUTES2|0|  
|SQL_LOCK_TYPES[1]|SQL_LCK_NO_CHANGE|  
|SQL_STATIC_CURSOR_ATTRIBUTES1|SQL_CA1_NEXT&#124; &#124; SQL_CA1_LOCK_NO_CHANGE SQL_CA1_BOOKMARK &#124; &#124; SQL_CA1_ABSOLUTESQL_CA1_RELATIVESQL_CA1_RELATIVESQL_CA1_RELATIVE&#124;&#124;&#124;&#124;SQL_CA1_POSITIONED_UPDATE &#124;SQL_CA1_POSITIONED_UPDATESQL_CA1_POSITIONED_DELETE&#124;SQL_CA1_POS_POSITION&#124;SQL_CA1_SELECT_FOR_UPDATE|  
|SQL_STATIC_CURSOR_ATTRIBUTES2|SQL_CA2_READ_ONLY_CONCUR&#124;SQL_CA2_OPT_VALUES_&#124;SQL_CA2_SENSITIVITY_UPDATES|  
|SQL_POS_OPERATIONS[1]|SQL_POS_POSITION|  
|SQL_POSITIONED_STATEMENTS[1]|SQL_PS_POSITIONED_DELETESQL_PS_POSITIONED_UPDATE&#124;SQL_PS_SELECT_FOR_UPDATE&#124;|  
|SQL_ROW_UPDATES|"Y"|  
|SQL_SCROLL_CONCURRENCY[1]|SQL_SCCO_READ_ONLY&#124;SQL_SCCO_OPT_VALUES|  
|SQL_SCROLL_OPTIONS|SQL_SO_FORWARD_ONLY&#124;SQL_SO_STATIC|  
|SQL_STATIC_SENSITIVITY[1]|SQL_SS_UPDATES|  
  
 [1] 仅在光标库与 ODBC 2.x 驱动程序一起使用时使用。  
  
> [!IMPORTANT]  
>  当提交或回滚与数据源的事务时，游标库实现相同的游标行为。 也就是说，通过调用**SQLEndTran**或使用SQL_ATTR_AUTOCOMMIT连接属性提交或回滚事务，可能会导致数据源删除访问计划并关闭连接上所有语句的游标。 有关详细信息，请参阅[SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md)中SQL_CURSOR_COMMIT_BEHAVIOR和SQL_CURSOR_ROLLBACK_BEHAVIOR信息类型。
