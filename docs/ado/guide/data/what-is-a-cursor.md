---
title: "游标是什么？ | Microsoft Docs"
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: ado
ms.technology: drivers
ms.custom: 
ms.date: 01/19/2017
ms.reviewer: 
ms.suite: sql
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
caps.latest.revision: "10"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 5f4439986c9e1debc2c2fd3e510f53da729e82c0
ms.sourcegitcommit: cc71f1027884462c359effb898390c8d97eaa414
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/21/2017
---
# <a name="what-is-a-cursor"></a>游标是什么？
关系数据库中的操作会对整个行集起作用。 由 SELECT 语句返回的行集包括满足该语句的 WHERE 子句中条件的所有行。 这种由语句返回的完整行集称为结果集。 应用程序，特别是那些处于交互式并处于联机状态，始终能有效地使用整个结果集作为一个单元。 这些应用程序需要一种机制以便每次处理一行或一部分行。 游标就是提供这种机制的对结果集的一种扩展。  
  
 游标实现的游标库。 游标库是软件，通常实现作为一部分的数据库系统或数据访问 API，用于管理从数据源 （结果集） 返回的数据的属性。 这些属性包括并发管理、 放置在结果集中返回的行数，以及是否可以移动向前或向后 （或两者） 结果设置 （可滚动性）。  
  
 游标跟踪结果集中的位置，并允许你执行多个操作针对结果集，也可以不返回到原始表的行。 换而言之，游标从概念上讲返回基于数据库中的表的结果集。 光标是这样命名是因为它指示结果集中当前位置一样将光标放在计算机屏幕指示当前的位置。  
  
 请务必在继续若要了解在 ADO 中其用法的详细信息之前应熟悉游标的概念。  
  
 使用游标，你可以：  
  
-   指定定位在结果集中的特定行。  
  
-   检索一行或块，这些基于当前的结果集位置的行。  
  
-   修改在结果集中当前位置行中的数据。  
  
-   向其他用户所做的数据更改定义不同级别的敏感度。  
  
 例如，假设一个应用程序潜在购买者会显示可用产品的列表。 买方滚动列表以查看产品详细信息和成本，并最终选择一个产品进行购买。 对列表的其余部分会出现其他滚动和所选内容。 就关心的是购买者，产品会出现一次，但应用程序使用可滚动游标向上和向下浏览结果集。  
  
 你可以使用各种不同的方式的游标：  
  
-   不用于任何行。  
  
-   完成部分或全部单个表中的行。  
  
-   完成部分或全部从逻辑上联接的表的行。  
  
-   为只读或可更新在光标或字段级别。  
  
-   为只进或完全可滚动。  
  
-   位于服务器上的游标键集。  
  
-   敏感导致其他应用程序 （如成员身份、 排序、 插入、 更新和删除中） 的基础表更改。  
  
-   现有服务器或客户端上。  
  
 只读游标帮助浏览结果集和读/写游标可以实现单个行更新的用户。 可以使用指回到表行的键集定义复杂的游标。 尽管某些游标是在一个向前方向以只读的其他人可以来回移动，并提供基于其他应用程序要对数据库进行的更改结果集的动态刷新。  
  
 并非所有应用程序需要使用游标来访问或更新数据。 某些查询完全不需要直接行更新通过使用游标。 游标应为你选择检索数据的最后一个技术之一，然后应选择可能的最低影响光标。 当你创建一个结果集，通过使用存储的过程时，结果集不是可更新使用光标编辑或更新方法。  
  
## <a name="concurrency"></a>并发  
 在某些多用户的应用程序是向最终用户若要为当前显示的数据非常重要。 此类系统的一个典型示例是航空订票系统，其中许多用户可能会争着为给定的航班 （并因此，单个记录） 的同一座位。 在这种情况下，应用程序设计必须处理针对单个记录的并发操作。  
  
 在其他应用程序，并发不一样重要。 在这种情况下，不能两端对齐保留当前的数据在所有时间费用。  
  
## <a name="position"></a>位置  
 游标还将跟踪的结果集中当前位置。 将光标位置作为指向当前记录，类似的方式的数组索引指向数组中的特定位置处的值。  
  
## <a name="scrollability"></a>可滚动性  
 你的应用程序所使用的游标类型也会影响结果集; 中的行中向前和向后移动的能力这有时称为可滚动性。 能够向前移动*和*逆向结果集将添加到光标处的复杂性，因此实现成本更高。 为此，你应该使用此功能仅在必要时对于游标要求。
