---
title: 定义文本格式（文本文件驱动程序） |微软文档
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 29dc46525f3c81e5abffe5076988716a01df06df
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307658"
---
# <a name="defining-text-format-text-file-driver"></a>定义文本格式（文本文件驱动程序）
使用文本驱动程序时，可以使用 **"定义文本格式"** 对话框来定义所选文件中列的格式。 此对话框使您能够为每个数据表指定架构。 此信息写入数据源目录中的架构.ini 文件。 为每个文本数据源目录创建单独的架构.ini 文件。  
  
> [!NOTE]  
>  相同的默认文件格式适用于所有新的文本数据表。 CREATE TABLE 语句创建的所有文件都继承相同的默认格式值，这些值是通过在 **"定义文本格式"** 对话框中选择文件格式值以及"\<**表**"列表中选择默认>来设置的。 Text 驱动程序不会更改现有文本文件的格式以匹配此对话框中定义的格式，但在使用该格式时（如尝试从文本文件检索数据时）将返回错误。  
  
 以下选项在 **"定义文本格式"** 对话框中可用：  
  
|选项|信息|  
|------------|-----------------|  
|**添加**|使用对话框中的 **"数据类型**"、"**名称**"和"**宽度"** 中的值添加列，如果适用，则从 Schema.ini 添加日期分隔符值。|  
|**字符**|**ANSI**或**OEM**。 OEM 指定非 ANSI 字符集。 如果 **"表"** 列表中选择的项的格式以前未由此对话框定义，则默认为 OEM。|  
|**列名称标题**|指示所选表的第一行的列是否用作列名称。 TRUE **TRUE**或**FALSE**。 如果 **"表"** 列表中选择的项的格式以前未由此对话框定义，则默认为 FALSE。|  
|**列**|列出所选表中每列的列名称。 列的顺序反映表中列的顺序。 如果在 **"表"** 列表中选择了文件，则启用此列表。|  
|**数据类型**|可以是 BIT、字节、CHAR、货币、日期、浮点、整数、长字符、短项或单。 日期数据类型可以采用以下格式："dd-mmm-yy"、"mm-d-yy"、"mm-d-yy"、"yyyy-mm-dd"或"yyyy-mmm-dd"。 "mm"表示月的数字;"mm"表示数月的字母。|  
|**分隔符**|指定用于分隔列的自定义分隔符字符。 选择**自定义分隔**格式时启用。 分隔符的长度只能是一个字符，双引号（"）不能用作分隔符字符。 （不能以十六进制或十进制格式指定分隔符。|  
|**格式**|分隔长度或固定长度。 如果分隔，指示使用的分隔符类型：逗号 （CSV）、选项卡或特殊字符（自定义）。 如果 **"表"** 列表中选定的项的格式以前未由此对话框定义，则此默认值为**CSV 分隔**。<br /><br /> 如果**格式**是固定长度的，并且**列名称标题**为 TRUE，则第一行必须表示逗号分隔。|  
|**想**|根据 **"格式"** 框选择扫描表的内容，自动生成所选表中列的数据类型、名称和宽度值。 在表格式被分隔时启用。 **"列"** 列表中以前定义的任何列都将被清除并替换为新条目。 如果未选择**列名称标题**，则列名称将自动生成为"F1"、"F2"等。 **"数据类型"** 框中不显示默认值。<br /><br /> 此功能仅适用于小于 64，513 字节的列。|  
|**修改**|使用 **"数据类型**"、"**名称**"和"**宽度**"中的值修改所选列。|  
|**名称**|显示所选列的名称。 可用于为现有列或新列指定新列名称。<br /><br /> 如果**列名称标题**为 TRUE，则忽略显示的列名称。|  
|**移除**|删除所选列。|  
|**要扫描的行**|设置或驱动程序在基于现有数据设置列和列数据类型时将扫描的行数。<br /><br /> 您可以输入一个数字从 1 到 32767 用于要扫描的行数。 如果 **"表"** 列表中选择的项的格式以前未由此对话框定义，则默认为 25。 （超出限制的数字将返回错误。|  
|**表**|包含"**文本设置"** 对话框中选择的目录中所有文件的列表，这些文件与指定的扩展名列表匹配。<br /><br /> 选择\<默认>，并且其中一个为 true 时，**表**组中表属性的值将写入 Schema.ini（未触及 Schema.ini 中的其他条目）：<br /><br /> - 指定目录中没有架构.<br />- Schema.ini 文件存在，但在 Schema.ini 中不存在目录中文本文件之一（具有指定扩展名）的节。<br />- 文本文件的部分存在于 Schema.ini 中，但正文为空。<br /><br /> 选择\<默认>时，将禁用 **"列"** 组。|  
|**宽度**|可以为 CHAR 或 LONGCHAR 列更改列的宽度。 如果 **"表"** 列表中选择的项的格式以前未由此对话框定义，则宽度默认为 1。<br /><br /> 对于其他数据类型，将禁用宽度控件，并且不显示任何值。|
