---
title: 什么是游标？ | Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- cursors [ADO], about cursors
ms.assetid: 596eb4b6-c22f-4cde-b23f-172dd66c3161
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 9ad683af9cea8ca4f5bc1736a48f0662656b6ef1
ms.sourcegitcommit: 074d44994b6e84fe4552ad4843d2ce0882b92871
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/05/2019
ms.locfileid: "66704513"
---
# <a name="what-is-a-cursor"></a>什么是游标？
关系数据库中的操作会对整个行集起作用。 由 SELECT 语句返回的行集包括满足该语句的 WHERE 子句中条件的所有行。 这种由语句返回的完整行集称为结果集。 应用程序，尤其是那些以交互式且已联机，总能有效地处理使用整个结果集作为一个单元中。 这些应用程序需要一种机制以便每次处理一行或一部分行。 游标就是提供这种机制的对结果集的一种扩展。  
  
 由游标库实现游标。 游标库是软件，通常作为数据库系统或数据访问 API 的一部分实现，用于管理从数据源 （结果集） 返回的数据的属性。 这些属性包括并发管理、 定位在结果集中返回的行数，以及是否可以移动向前或向后 （或两者） 通过结果集 （可滚动性）。  
  
 游标跟踪结果集中的位置，并允许您执行多个操作针对结果集，也可以不返回到原始表行的行。 换而言之，游标从概念上讲返回基于数据库中的表的结果集。 游标是如此命名是因为它指示结果集中当前位置就像在计算机屏幕上的光标指示当前位置。  
  
 请务必熟悉游标的概念在继续之前要了解在 ADO 中及其用法的详细信息。  
  
 使用游标，您可以：  
  
-   指定定位在结果集中的特定行。  
  
-   检索一行或一部分基于当前结果集位置的行。  
  
-   修改在结果集中当前位置的行中的数据。  
  
-   定义由其他用户所做的数据更改的不同级别的敏感度。  
  
 例如，考虑到潜在购买者显示的可用产品列表的应用程序。 买方滚动浏览列表以查看产品详细信息和成本，并最终选择要购买的产品。 其他滚动和选择列表的剩余时间内发生。 就买方的情况下，产品会出现一次一个地，但应用程序使用可滚动游标向上和向下浏览结果集。  
  
 可以使用不同的方式中的游标：  
  
-   不用于任何行。  
  
-   完成部分或全部单个表中的行。  
  
-   完成部分或全部从逻辑上联接表的行。  
  
-   为只读或可更新游标或字段级别。  
  
-   为只进或完全可滚动。  
  
-   位于服务器上的游标键集。  
  
-   更改敏感的基础表 （如成员身份、 排序、 插入、 更新和删除） 的其他应用程序所引起。  
  
-   现有服务器或客户端上。  
  
 只读游标，帮助用户浏览结果集和读/写游标可以实现单个行的更新。 可以使用指回到基础表行的键集定义复杂的游标。 尽管某些游标是只读向前定位，但其他人可以来回移动，并提供基于其他应用程序正在对数据库进行的更改的结果集的动态刷新。  
  
 并非所有应用程序需要使用游标来访问或更新数据。 某些查询只是不需要将行定向更新通过使用游标。 游标应为一种选择来检索数据的最后一个技术-然后应选择最小可能的影响游标。 在创建结果集所使用的存储的过程时，结果集不是可更新使用游标编辑或更新方法。  
  
## <a name="concurrency"></a>并发  
 在某些多用户应用程序是用于向最终用户要尽可能的新提供的数据非常重要。 此类系统的典型示例是航空订票系统，其中许多用户可能会争着为给定的航班 （并因此，一条记录） 的同一个座位。 在这种情况下，应用程序设计必须处理一条记录上的并发操作。  
  
 在其他应用程序中，并发性不那么重要。 在这种情况下，不太现实中保留当前的数据在任何时候所涉及的开销。  
  
## <a name="position"></a>位置  
 游标还跟踪的结果集中当前位置。 将光标位置为指向当前记录的方式类似的数组索引指向该数组中的特定位置处的值。  
  
## <a name="scrollability"></a>可滚动性  
 你的应用程序所使用的游标类型还会影响，能够将向前和向后移动一个结果集; 中的所有行这有时称为可滚动性。 向前移动的能力*和*向后移动一个结果集将添加到光标处的复杂性，因此实现成本更高。 出于此原因，您应使用此功能仅在必要时的游标要求。
