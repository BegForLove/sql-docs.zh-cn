---
title: 定义文本格式（文本文件驱动程序） |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 500a81146397fa5c50bd8b74c600d04887ecc99c
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/08/2020
ms.locfileid: "68096355"
---
# <a name="defining-text-format-text-file-driver"></a>定义文本格式（文本文件驱动程序）
使用文本驱动程序时，可以使用 "**定义文本格式**" 对话框来定义所选文件中的列的格式。 利用此对话框，您可以为每个数据表指定架构。 此信息将写入到数据源目录中的一个 schema.ini 文件中。 为每个文本数据源目录创建一个单独的架构 .ini 文件。  
  
> [!NOTE]  
>  同一默认文件格式适用于所有新的文本数据表。 CREATE TABLE 语句创建的所有文件都继承这些默认格式值，这些值是通过在 "**定义文本格式**" 对话框中选择 "文件格式" \<值并在 "**表**" 列表中选择默认> 来设置的。 文本驱动程序不会更改现有文本文件的格式以与此对话框中定义的格式匹配，但当它使用格式（例如，尝试从文本文件中检索数据时），将返回错误。  
  
 "**定义文本格式**" 对话框中提供了以下选项：  
  
|选项|信息|  
|------------|-----------------|  
|**添加**|使用 "**数据类型**" 中的值、"**名称**" 和 "**宽度**" 中的值添加列（如果适用），并从 "schema.ini" 的日期分隔符值（如果适用）。|  
|**字符**|**ANSI**或**OEM**。 OEM 指定非 ANSI 字符集。 如果此对话框以前没有定义 "**表**" 列表中选定项的格式，则默认为 OEM。|  
|**列名称标头**|指示所选表中第一行的列是否用作列名称。 **TRUE**或**FALSE**。 如果此对话框以前尚未定义 "**表**" 列表中选定项的格式，则默认值为 FALSE。|  
|**“列”**|列出所选表中每一列的列名。 列的顺序反映了表中各列的顺序。 如果在 "**表**" 列表中选择了某个文件，则会启用此列表。|  
|**数据类型**|可以是 BIT、BYTE、CHAR、CURRENCY、DATE、FLOAT、INTEGER、LONGCHAR、SHORT 或 SINGLE。 日期数据类型可以采用以下格式： "yyyy-mm-dd"、"mm-dd-yy"、"mmm-yy"、"yyyy-mm-dd" 或 "yyyy-dd-dd"。 "mm" 表示月数;"mmm" 表示月的字母。|  
|**后面**|指定要用于分隔列的自定义分隔符字符。 选择**自定义分隔**格式后启用。 分隔符的长度只能为一个字符，而双引号（"）不能用作分隔符字符。 （分隔符不能以十六进制或十进制格式指定。）|  
|**形式**|分隔或固定长度。 如果是分隔的，则指示使用的分隔符类型：逗号（CSV）、制表符或特殊字符（自定义）。 如果此对话框以前没有定义 "**表**" 列表中选定项的格式，则默认为**CSV 分隔**的值。<br /><br /> 如果**Format**为固定长度并且**列名称标头**为 TRUE，则第一行必须以逗号分隔。|  
|**Guess**|根据选择的**格式**框，自动为所选表中的列生成列的数据类型、名称和宽度值。 在分隔表格式时启用。 **列**列表中任何以前定义的列都将被清除并替换为新条目。 如果未选择**列名称标题**，则列名称将自动生成为 "F1"、"F2" 等。 "**数据类型**" 框中没有显示默认值。<br /><br /> 此功能仅适用于小于64513个字节的列。|  
|**修改**|使用 "**数据类型**"、"**名称**" 和 "**宽度**" 中的值修改所选列。|  
|**名称**|显示所选列的名称。 可用于为现有列或新列指定新的列名。<br /><br /> 如果**列名称标头**为 TRUE，则将忽略显示的列名称。|  
|**删除**|删除所选列。|  
|**要扫描的行**|设置或驱动程序在基于现有数据设置列和列数据类型时将扫描的行数。<br /><br /> 对于要扫描的行数，可以输入1到32767之间的数字。 如果此对话框以前尚未定义 "**表**" 列表中选定项的格式，则默认值为25。 （超出限制的数字将返回错误。）|  
|**表**|包含在 "**文本设置**" 对话框中所选目录中与指定扩展名匹配的所有文件的列表。<br /><br /> 如果\<选择了 "默认>"，并且以下条件之一为 true，则**表**组中表属性的值将写入 schema.ini （不涉及 schema.ini 中的其他项）：<br /><br /> -指定目录中没有 schema.ini。<br />-该 schema.ini 文件存在，但在目录中的一个文本文件（具有指定扩展名）中没有节。<br />-文本文件的部分存在于 schema.ini 中，但正文为空。<br /><br /> 选择\<默认> 时，将禁用**列**组。|  
|宽度 |对于 CHAR 或 LONGCHAR 列，可以更改列的宽度。 如果此对话框以前尚未定义 "**表**" 列表中选定项的格式，则宽度默认为1。<br /><br /> 对于其他数据类型，将禁用 width 控件且不显示任何值。|
