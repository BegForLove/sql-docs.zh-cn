---
title: 何时使用过程 |微软文档
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 31aeea226bc8c8aa41f748d1d9a97d55147c4d67
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81289094"
---
# <a name="when-to-use-procedures"></a>何时使用过程
使用过程有很多优点，所有这些都基于使用过程将 SQL 语句从应用程序移动到数据源这一事实。 应用程序中剩下的是可互操作的过程调用。 这些优势包括：  
  
-   **性能**过程通常是执行 SQL 语句的最快方法。 与准备执行一样，语句分两步编译和执行。 与准备执行不同，过程仅在运行时执行。 它们在不同的时间编译。  
  
-   **业务规则***业务规则*是关于公司开展业务方式的规则。 例如，可能只允许具有"销售人员"标题的人员添加新的销售订单。 将这些规则放在程序中允许单个公司通过重写应用程序调用的过程来自定义垂直应用程序，而无需修改应用程序代码。 例如，订单输入应用程序可能会调用具有固定数量的参数的过程**InsertOrder;****InsertOrder**的实现方式可能因公司而异。  
  
-   **可更换性**与将业务规则放在程序中密切相关，即无需重新编译应用程序即可替换过程。 如果业务规则在公司购买并安装应用程序后发生更改，则公司可以更改包含该规则的过程。 从应用程序的角度来看，没有任何变化;它仍然调用特定过程来完成特定任务。  
  
-   **特定于 DBMS 的 SQL**过程为应用程序提供了一种利用特定于 DBMS 的 SQL 的方法，并且仍保持可互操作。 例如，在 DBMS 上支持 SQL 中的流控制语句的过程可能会捕获并从错误中恢复，而不支持流控制语句的 DBMS 上的过程可能只是返回错误。  
  
-   **程序在交易中存活**在某些数据源上，当提交或回滚事务时，连接上所有准备好的语句的访问计划将被删除。 通过将 SQL 语句放在永久存储在数据源中的程序中，这些语句在事务中存活下来。 过程是处于准备、部分准备或未准备状态的，都是特定于 DBMS 的。  
  
-   **单独开发**过程可以独立于应用程序的其余部分开发。 在大公司中，这可能为进一步利用高度专业化的程序员的技能提供一种方法。 换句话说，应用程序程序员可以编写用户界面代码，数据库程序员可以编写过程。  
  
 垂直和自定义应用程序通常使用过程。 这些应用程序倾向于执行固定任务，并且可以在其中硬编码过程调用。 例如，订单输入应用程序可能会调用 **"插入订单**"、"**删除订单**"、"**更新订单"** 和"**获取订单**"的过程。  
  
 从通用应用程序调用过程几乎没有理由。 过程通常编写用于在特定应用程序的上下文中执行任务，因此对泛型应用程序没有用。 例如，电子表格没有理由调用刚才提到的**InsertOrder**过程。 此外，泛型应用程序不应在运行时构造过程，希望提供更快的语句执行;这不仅可能比准备或直接执行慢，还需要特定于 DBMS 的 SQL 语句。  
  
 应用程序的一个例外是应用程序开发环境，它通常为程序员提供一种构建 SQL 语句的方法，这些语句执行过程，并可能为程序员提供一种测试过程的方法。 此类环境调用**SQLProcess**列出可用过程和**SQLProcess 列**，以列出过程创建的任何结果集的输入、输入/输出和输出参数、过程返回值以及列。 但是，必须事先在每个数据源上制定此类程序;这样做需要特定于 DBMS 的 SQL 语句。  
  
 使用过程有三个主要缺点。 第一，必须为应用程序要使用的每个 DBMS 编写和编译过程。 虽然这不是自定义应用程序的问题，但它可以显著增加垂直应用程序的开发和维护时间，这些应用旨在使用多个 DBMS 运行。  
  
 第二个缺点是许多 DBMS 不支持过程。 同样，对于设计为使用许多 DBMS 运行的垂直应用程序来说，这很可能是一个问题。 要确定是否支持过程，应用程序使用SQL_PROCEDURES选项调用**SQLGetInfo。**  
  
 第三个缺点是 ODBC 没有定义用于创建过程的标准语法，这尤其适用于应用程序开发环境。 也就是说，尽管应用程序可以互操作调用过程，但它们不能以互操作性创建它们。
